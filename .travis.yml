language: android
jdk: oraclejdk8
sudo: false
env:
  global:
    - BUS_STOP_MAJOR_VERSION=0
    - BUS_STOP_MINOR_VERSION=1
android:
  components:
  - tools
  - tools
  - platform-tools
  - build-tools-26.0.2
  - android-22
  - android-26
  - extra-google-google_play_services
  - extra-google-m2repository
  - extra-android-m2repository
  - addon-google_apis-google-26
  - sys-img-armeabi-v7a-android-22
before_script:
- echo no | android create avd --force -n test -t android-22 --abi armeabi-v7a
- emulator -avd test -no-audio -no-window &
- android-wait-for-emulator
- adb shell input keyevent 82 &
script:
  - ./gradlew build connectedCheck
  - ./gradlew clean assembleDebug
before_install:
- chmod +x gradlew
before_deploy:
  - git config --local user.name "Reccy"
  - git config --local user.email "aaronmeaney@hotmail.com"
  - git tag -a ${BUS_STOP_MAJOR_VERSION}.${BUS_STOP_MINOR_VERSION} -m "Travis build $TRAVIS_BUILD_NUMBER pushed a tag."
deploy:
  provider: releases
  api_key:
    secure: UNmVC92Ngfcpccx9RHyWxRvFSb7tWwtuOpJLdvy98zAylu40MWEpP1GAVGOxpDjEsGWIsd7iXvTo3vdZjp2l1I28bQqRuzzErd9faGifr13DLxKxk86BaoyhGqEgRHfPr3yVujdDgE2nSMnesc4jcnYcI1FO8Ji7MCIW0xwWgOSqPWTjB+w5xXJaP8Ze9zIemb9/zNfKaN91ViB74F2n1WEDItJ+/mFpBEEMe9le5MQSuaUiVdHocFDopYLsA1n7CkCjBKSSNAQl5RgES9uVuPSJJSGxhU9lSlZdzWqPJ1TYw1cM1YpiZa5ZYUGtdDXurKcOdQ/e3MwFwmb8v6dafNwimGfGMO6Dc4bbrtJZuKEwVCmfQylV53JTCmeSGd+wHnyVzdmOPwrshLov22a5dc5RLRYpKw2giIuRRLPFkjebC8ImIdwugc1+VKebGRj04GtlmCVORPTQctCAyGNiVGYZJ+tmoW2jYYYBTZIXR9yChTo2yXxt2MIGka17FODwczEznrnVbbIhfS73BseibgQCf9n8aEHlFBdy3CmyKPizw0PxBLwXbD2UQsfEtZfNOAO4UI5NPWooLBlvgHEmrJZ40bVc/J9mBv4dCTBAENP7fCXdLd+30AR1TRrwL0gGF6rl1EpOm7GeFcdarEoW0Xy5U31ZxFkghRxyO2oH36Y=
  file_glob: true
  skip_cleanup: true
  file: app/build/outputs/apk/debug/bus-stop*.apk
  on:
    repo: Reccy/college-bus_app_android
    branches:
      only:
        - master